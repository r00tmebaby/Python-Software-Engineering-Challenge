Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [3036] using statreload
The --reload flag should not be used in production on Windows.
Started server process [10700]
Waiting for application startup.
Application startup complete.
Stopping reloader process [3036]
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [20484] using statreload
The --reload flag should not be used in production on Windows.
Started server process [3844]
Waiting for application startup.
Application startup complete.
Shutting down
Stopping reloader process [20484]
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [8156] using statreload
The --reload flag should not be used in production on Windows.
Started server process [3844]
Waiting for application startup.
Application startup complete.
Shutting down
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [17244] using statreload
The --reload flag should not be used in production on Windows.
Started server process [23328]
Waiting for application startup.
Application startup complete.
Stopping reloader process [17244]
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [26228] using statreload
The --reload flag should not be used in production on Windows.
Started server process [26104]
Waiting for application startup.
Application startup complete.
Shutting down
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [24020] using statreload
The --reload flag should not be used in production on Windows.
Started server process [24264]
Waiting for application startup.
Application startup complete.
Stopping reloader process [24020]
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [19096] using statreload
The --reload flag should not be used in production on Windows.
Started server process [25324]
Waiting for application startup.
Application startup complete.
Stopping reloader process [19096]
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [25832] using statreload
The --reload flag should not be used in production on Windows.
Started server process [9140]
Waiting for application startup.
Application startup complete.
StatReload detected file change in 'pytest.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [26152]
Waiting for application startup.
Application startup complete.
Shutting down
Stopping reloader process [25832]
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [25552] using statreload
The --reload flag should not be used in production on Windows.
Started server process [25772]
Waiting for application startup.
Application startup complete.
127.0.0.1:34895 - "GET / HTTP/1.1" 307
127.0.0.1:34895 - "GET /docs HTTP/1.1" 200
127.0.0.1:34895 - "GET /openapi.json HTTP/1.1" 200
127.0.0.1:34896 - "GET /search?order_by=DESC&search_type=alias&sort_by=roas&limit=10&page=1 HTTP/1.1" 401
Shutting down
Stopping reloader process [25552]
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [5560] using statreload
The --reload flag should not be used in production on Windows.
Started server process [4100]
Waiting for application startup.
Application startup complete.
127.0.0.1:35027 - "GET / HTTP/1.1" 307
127.0.0.1:35027 - "GET /docs HTTP/1.1" 200
127.0.0.1:35027 - "GET /openapi.json HTTP/1.1" 200
127.0.0.1:35027 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 401
127.0.0.1:35028 - "GET /search?order_by=ASC&search_type=alias&sort_by=roas&limit=10&page=2 HTTP/1.1" 401
127.0.0.1:35028 - "GET /search?order_by=ASC&search_type=alias&sort_by=roas&limit=10&page=1 HTTP/1.1" 401
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [18832]
Waiting for application startup.
Application startup complete.
Shutting down
Waiting for application shutdown.
Application shutdown complete.
Finished server process [18832]
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [22700] using statreload
The --reload flag should not be used in production on Windows.
Started server process [10008]
Waiting for application startup.
Application startup complete.
Shutting down
Will watch for changes in these directories: ['F:\\Programming\\Python\\bidnamic-python-challenge1']
Uvicorn running on http://0.0.0.0:8090 (Press CTRL+C to quit)
Started reloader process [11308] using statreload
The --reload flag should not be used in production on Windows.
Started server process [5952]
Waiting for application startup.
Application startup complete.
127.0.0.1:4969 - "GET / HTTP/1.1" 307
127.0.0.1:4969 - "GET /docs HTTP/1.1" 200
127.0.0.1:4969 - "GET /openapi.json HTTP/1.1" 200
127.0.0.1:4969 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 401
127.0.0.1:4970 - "POST /session HTTP/1.1" 200
127.0.0.1:4970 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 200
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [18504]
Waiting for application startup.
Application startup complete.
127.0.0.1:5332 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 200
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [780]
Waiting for application startup.
Application startup complete.
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [26088]
Waiting for application startup.
Application startup complete.
127.0.0.1:5471 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 53, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) syntax error at or near "distinct"
LINE 1: ...ch_terms.campaign_id AS search_terms_campaign_id, distinct(s...
                                                             ^

[SQL: SELECT search_terms.campaign_id AS search_terms_campaign_id, distinct(search_terms.search_term) AS distinct_1, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [9112]
Waiting for application startup.
Application startup complete.
127.0.0.1:5510 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 53, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) SELECT DISTINCT ON expressions must match initial ORDER BY expressions
LINE 1: SELECT DISTINCT ON (search_terms.campaign_id) search_terms.c...
                            ^

[SQL: SELECT DISTINCT ON (search_terms.campaign_id) search_terms.campaign_id AS search_terms_campaign_id, search_terms.search_term AS search_terms_search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
127.0.0.1:5511 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 53, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) SELECT DISTINCT ON expressions must match initial ORDER BY expressions
LINE 1: SELECT DISTINCT ON (search_terms.campaign_id) search_terms.c...
                            ^

[SQL: SELECT DISTINCT ON (search_terms.campaign_id) search_terms.campaign_id AS search_terms_campaign_id, search_terms.search_term AS search_terms_search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [23656]
Waiting for application startup.
Application startup complete.
127.0.0.1:5533 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 53, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) SELECT DISTINCT ON expressions must match initial ORDER BY expressions
LINE 1: SELECT DISTINCT ON (search_terms.search_term) search_terms.c...
                            ^

[SQL: SELECT DISTINCT ON (search_terms.search_term) search_terms.campaign_id AS search_terms_campaign_id, search_terms.search_term AS search_terms_search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [24988]
Waiting for application startup.
Application startup complete.
127.0.0.1:5564 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 53, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) SELECT DISTINCT ON expressions must match initial ORDER BY expressions
LINE 1: SELECT DISTINCT ON (search_terms.search_term) search_terms.c...
                            ^

[SQL: SELECT DISTINCT ON (search_terms.search_term) search_terms.campaign_id AS search_terms_campaign_id, search_terms.search_term AS search_terms_search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [4548]
Waiting for application startup.
Application startup complete.
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [19960]
Waiting for application startup.
Application startup complete.
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [25808]
Waiting for application startup.
Application startup complete.
127.0.0.1:5649 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 401
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [10936]
Waiting for application startup.
Application startup complete.
127.0.0.1:5683 - "POST /session HTTP/1.1" 200
127.0.0.1:5683 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 53, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) syntax error at or near "DISTINCT"
LINE 1: ...ch_terms.campaign_id AS search_terms_campaign_id, DISTINCT s...
                                                             ^

[SQL: SELECT search_terms.campaign_id AS search_terms_campaign_id, DISTINCT search_terms.search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [13900]
Waiting for application startup.
Application startup complete.
127.0.0.1:5709 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 53, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) SELECT DISTINCT ON expressions must match initial ORDER BY expressions
LINE 1: SELECT DISTINCT ON (search_terms.search_term) search_terms.c...
                            ^

[SQL: SELECT DISTINCT ON (search_terms.search_term) search_terms.campaign_id AS search_terms_campaign_id, search_terms.search_term AS search_terms_search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
167.94.145.59:50012 - "GET / HTTP/1.1" 307
167.94.145.59:49972 - "GET / HTTP/1.1" 307
167.94.145.59:52212 - "PRI %2A HTTP/2.0" 404
Invalid HTTP request received.
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 685, in __call__
    await self.default(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 579, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 129, in handle_events
    event = self.conn.next_event()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_connection.py", line 485, in next_event
    exc._reraise_as_remote_protocol_error()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_util.py", line 77, in _reraise_as_remote_protocol_error
    raise self
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_connection.py", line 467, in next_event
    event = self._extract_next_receive_event()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_connection.py", line 409, in _extract_next_receive_event
    event = self._reader(self._receive_buffer)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_readers.py", line 85, in maybe_read_from_IDLE_client
    matches = validate(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_util.py", line 91, in validate
    raise LocalProtocolError(msg)
h11._util.RemoteProtocolError: illegal request line: bytearray(b'SM')
167.94.145.59:53586 - "GET /docs HTTP/1.1" 200
167.94.145.59:55594 - "PRI %2A HTTP/2.0" 404
Invalid HTTP request received.
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 685, in __call__
    await self.default(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 579, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 129, in handle_events
    event = self.conn.next_event()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_connection.py", line 485, in next_event
    exc._reraise_as_remote_protocol_error()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_util.py", line 77, in _reraise_as_remote_protocol_error
    raise self
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_connection.py", line 467, in next_event
    event = self._extract_next_receive_event()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_connection.py", line 409, in _extract_next_receive_event
    event = self._reader(self._receive_buffer)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_readers.py", line 85, in maybe_read_from_IDLE_client
    matches = validate(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\h11\_util.py", line 91, in validate
    raise LocalProtocolError(msg)
h11._util.RemoteProtocolError: illegal request line: bytearray(b'SM')
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [14452]
Waiting for application startup.
Application startup complete.
127.0.0.1:5723 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 200
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [8080]
Waiting for application startup.
Application startup complete.
127.0.0.1:5736 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 54, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) SELECT DISTINCT ON expressions must match initial ORDER BY expressions
LINE 1: SELECT DISTINCT ON (search_terms.search_term) search_terms.c...
                            ^

[SQL: SELECT DISTINCT ON (search_terms.search_term) search_terms.campaign_id AS search_terms_campaign_id, search_terms.search_term AS search_terms_search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC, search_terms.search_term 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [6356]
Waiting for application startup.
Application startup complete.
127.0.0.1:5740 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 200
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [6624]
Waiting for application startup.
Application startup complete.
127.0.0.1:5759 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 54, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) SELECT DISTINCT ON expressions must match initial ORDER BY expressions
LINE 1: SELECT DISTINCT ON (search_terms.search_term) search_terms.c...
                            ^

[SQL: SELECT DISTINCT ON (search_terms.search_term) search_terms.campaign_id AS search_terms_campaign_id, search_terms.search_term AS search_terms_search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [25944]
Waiting for application startup.
Application startup complete.
127.0.0.1:5764 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 500
Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 366, in run_asgi
    result = await app(self.scope, self.receive, self.send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 75, in __call__
    return await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 82, in __call__
    raise exc from None
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\uvicorn\middleware\message_logger.py", line 78, in __call__
    await self.app(scope, inner_receive, inner_send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\applications.py", line 261, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 181, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\middleware\errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    raise exc
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 656, in __call__
    await route.handle(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 259, in handle
    await self.app(scope, receive, send)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\starlette\routing.py", line 61, in app
    response = await func(request)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 227, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "F:\Programming\Python\bidnamic-python-challenge1\endpoints\search.py", line 53, in search
    for found_items in search_items:
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2887, in __iter__
    return self._iter().__iter__()
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\query.py", line 2894, in _iter
    result = self.session.execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\orm\session.py", line 1692, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1620, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\sql\elements.py", line 325, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1487, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1851, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2032, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1808, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\r00tme\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) SELECT DISTINCT ON expressions must match initial ORDER BY expressions
LINE 1: SELECT DISTINCT ON (search_terms.search_term) search_terms.c...
                            ^

[SQL: SELECT DISTINCT ON (search_terms.search_term) search_terms.campaign_id AS search_terms_campaign_id, search_terms.search_term AS search_terms_search_term, sum(search_terms.cost) AS total_cost, sum(search_terms.conversion_value) AS total_conversion_value, sum(search_terms.conversion_value) / sum(search_terms.cost) AS roas 
FROM search_terms 
WHERE search_terms.cost > %(cost_1)s GROUP BY search_terms.search_term, search_terms.campaign_id ORDER BY roas DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s]
[parameters: {'cost_1': 0, 'param_1': 10, 'param_2': 11}]
(Background on this error at: https://sqlalche.me/e/14/f405)
StatReload detected file change in 'endpoints\search.py'. Reloading...
The --reload flag should not be used in production on Windows.
Started server process [16044]
Waiting for application startup.
Application startup complete.
127.0.0.1:5777 - "GET /search?order_by=DESC&search_type=structure_value&sort_by=roas&limit=10&page=1 HTTP/1.1" 200
